<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Contact Pro Manager</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <header>
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
          <a class="navbar-brand" href="/">TP Contact Pro Manager</a>
          <div class="collapse navbar-collapse">
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link" aria-current="page" href="/"
                  >Liste des contacts</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/contact/new">Ajouter un contact</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>
    <div class="container">
      <div class="row">
        <div class="col-8 card shadow mx-auto my-5">
          <div class="card-body bg-dark p-5">
            <h3 class="text-center text-white">
              <%= data.contact.lastName %> <%= data.contact.firstName %>
            </h3>
            <hr />
            <ul class="list-group">
              <li class="list-group-item">
                <strong>Companie</strong>: <%= data.contact.company %>
              </li>
              <li class="list-group-item">
                <strong>Adresse</strong>: <%= data.contact.address %>
              </li>
              <li class="list-group-item">
                <strong>Téléphone</strong>: <%= data.contact.phone %>
              </li>
              <li class="list-group-item">
                <strong>Email</strong>: <%= data.contact.email %>
              </li>
              <li class="list-group-item">
                <strong>Secteur</strong>: <%= data.contact.sector %>
              </li>
            </ul>
          </div>
          <div class="card-footer bg-secondary">
            <div class="row">
              <div class="col-8">
                <ul>
                  <li>
                    <strong>Date de création</strong>: <%=
                    data.contact.created_at.toLocaleDateString("fr-FR", {
                    weekday: "short", day: "numeric", month: "long", hour:
                    "numeric", minute: "numeric", second: "numeric" }) %>
                  </li>
                  <li>
                    <strong>Date de modification</strong>: <%=
                    data.contact.updated_at.toLocaleDateString("fr-FR", {
                    weekday: "short", day: "numeric", month: "long", hour:
                    "numeric", minute: "numeric", second: "numeric" }) %>
                  </li>
                </ul>
              </div>
              <div class="col-4">
                <a
                  href="<%= `/contact/edit/${data.contact.id}` %>"
                  class="btn btn-warning"
                  >MODIFIER</a
                >
                <button
                  data-id="<%= `${data.contact.id}` %>"
                  class="btn btn-danger btn-delete"
                >
                  SUPPRIMER
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script>
      let btnDeletes = document.querySelectorAll(".btn-delete");

      btnDeletes.forEach((btnDelete) => {
        // ajoute l'évènement click sur chaque bouton
        btnDelete.addEventListener("click", (e) => {
          if (window.confirm("Voulez vous supprimer ce contact ?")) {
            // redirige vers l'url /contact/delete/id
            window.location.href =
              "/contact/delete/" + btnDelete.getAttribute("data-id");
          }
        });
      });
    </script>
  </body>
</html>
<!-- Passe un bon week end enculé ;) a lundi (marc)-->
